# Руководство по разработке

## Настройка среды разработки

### Установка расширений VSCode

Для удобной работы с проектом рекомендуется установить следующие расширения VSCode:

1. **ESLint** (`dbaeumer.vscode-eslint`) - проверка кода на соответствие правилам
2. **Prettier** (`esbenp.prettier-vscode`) - форматирование кода
3. **Auto Import** (`steoates.autoimport`) - автоматический импорт компонентов и функций
4. **TypeScript Importer** (`pmneo.tsimporter`) - улучшенный импорт для TypeScript
5. **Import Cost** (`wix.vscode-import-cost`) - показывает размер импортируемых пакетов
6. **TypeScript Next** (`ms-vscode.vscode-typescript-next`) - расширенная поддержка TypeScript
7. **Move TS** (`stringham.move-ts`) - перемещение и переименование файлов с обновлением импортов
8. **Path Intellisense** (`christian-kohler.path-intellisense`) - автодополнение путей
9. **IntelliCode** (`visualstudioexptteam.vscodeintellicode`) - ИИ-помощник для автодополнения

Все эти расширения можно установить автоматически, если открыть проект в VSCode и согласиться установить рекомендуемые расширения.

### Автоматический импорт и рефакторинг

В проекте настроены следующие возможности для автоматического управления импортами:

1. **Автоматическое обновление импортов при перемещении файлов**

   - При перемещении или переименовании файла через VSCode (F2 или правый клик -> Переименовать) импорты будут обновлены автоматически

2. **Автоматическое добавление отсутствующих импортов**

   - При сохранении файла VSCode автоматически добавит отсутствующие импорты

3. **Автоматическая организация импортов**
   - При сохранении файла импорты будут автоматически отсортированы и сгруппированы

### Переименование компонентов

Для переименования компонентов рекомендуется использовать следующие подходы:

1. **Использование расширения Move TS**

   - Выделите имя компонента
   - Нажмите F2 или правый клик -> Переименовать символ
   - Введите новое имя компонента
   - VSCode автоматически обновит все ссылки на этот компонент

2. **Использование команды "Rename Symbol"**

   - Поместите курсор на имя компонента
   - Нажмите F2 или правый клик -> Переименовать символ
   - Введите новое имя компонента

3. **Использование универсального инструмента рефакторинга**

   - Для более сложных случаев используйте скрипт `refactor`, который работает с TypeScript Language Service API через библиотеку ts-morph:

   ```bash
   # Переименование компонента
   npm run refactor rename-component app/components/Headers.tsx MainDescription NewMainDescription

   # Переименование файла с обновлением импортов
   npm run refactor rename-file app/components/headers.tsx app/components/Headers.tsx

   # Извлечение компонента в отдельный файл
   npm run refactor extract-component app/components/Headers.tsx SubComponent 10 25 app/components/SubComponent.tsx

   # Поиск всех использований компонента
   npm run refactor find-usages MainDescription
   ```

### Правила именования файлов

В проекте настроены следующие правила именования файлов:

1. **Компоненты React**: PascalCase (например, `Button.tsx`, `UserProfile.tsx`)
2. **Специальные файлы Next.js**: camelCase (например, `page.tsx`, `layout.tsx`)
3. **Утилиты и хуки**: camelCase (например, `useAuth.ts`, `formatDate.ts`)

Для автоматической проверки соответствия этим правилам используется ESLint с плагином `unicorn/filename-case`.

## Универсальный инструмент рефакторинга

В проекте реализован универсальный инструмент рефакторинга на основе библиотеки ts-morph, которая предоставляет удобный API для работы с TypeScript Compiler API. Этот инструмент заменяет ранее использовавшиеся скрипты `rename-files.js` и `rename-components.js`, предоставляя более мощные и надежные возможности рефакторинга.

### 1. Переименование компонента

```bash
npm run refactor rename-component <путь-к-файлу> <старое-имя> <новое-имя>
```

Эта команда:

- Находит компонент с указанным именем в указанном файле
- Переименовывает его на новое имя
- Автоматически обновляет все импорты и использования этого компонента во всех файлах проекта

### 2. Переименование файла

```bash
npm run refactor rename-file <старый-путь> <новый-путь>
```

Эта команда:

- Переименовывает файл с указанного пути на новый
- Автоматически обновляет все импорты этого файла во всех файлах проекта

### 3. Извлечение компонента в отдельный файл

```bash
npm run refactor extract-component <путь-к-файлу> <имя-компонента> <начальная-строка> <конечная-строка> <новый-путь>
```

Эта команда:

- Извлекает код компонента из указанного файла (с указанной начальной по конечную строку)
- Создает новый файл с этим компонентом
- Добавляет необходимые импорты в новый файл
- Заменяет код компонента в исходном файле на импорт из нового файла

### 4. Поиск использований компонента

```bash
npm run refactor find-usages <имя-компонента>
```

Эта команда:

- Находит все места использования компонента с указанным именем во всех файлах проекта
- Выводит список файлов, строк и контекст использования

## Команды для разработки

```bash
# Запуск проекта в режиме разработки
npm run dev

# Проверка кода на соответствие правилам
npm run lint

# Автоматическое исправление ошибок линтинга
npm run lint:fix

# Форматирование кода
npm run format

# Проверка имен файлов
npm run check-file-names

# Универсальный инструмент рефакторинга
npm run refactor <команда> [аргументы]
```
